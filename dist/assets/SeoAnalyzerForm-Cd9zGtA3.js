import{d as D,r as f,G as E,C as _,l as C,c as n,m as c,h as l,b as t,Q as g,H as v,I as y,i as T,k as W,_ as z}from"./index-Vb9Qnebq.js";import{u as M}from"./DashboardView-CA6wWSA0.js";const U={class:"modal-content"},B={class:"form-group"},F={class:"form-group"},O={class:"form-group"},A={key:0,class:"field-error"},q={class:"form-actions"},I=["disabled"],H={class:"btn-content"},L={key:0,class:"loading-spinner"},P={key:1},R={key:2},$={key:0,class:"result-section"},j={class:"result-content"},G={key:1,class:"error-section"},J={class:"error-message"},Q=D({__name:"SeoAnalyzerForm",props:{isVisible:{type:Boolean}},emits:["close","analysis-complete"],setup(K,{emit:N}){const w=N,p=M(),i=f(!1),d=f(null),u=f(""),s=E({keyword:"",brandName:"",brandWebsite:""}),r=new Map,b=o=>{if(r.has(o))return r.get(o);try{return new URL(o),r.set(o,!0),!0}catch{return r.set(o,!1),!1}},S=_(()=>b(s.brandWebsite)),k=_(()=>s.keyword.trim().length>0&&s.brandName.trim().length>0&&s.brandWebsite.trim().length>0&&S.value);C(()=>s.brandWebsite,()=>{if(r.size>100){const o=Array.from(r.entries());r.clear(),o.slice(-50).forEach(([e,a])=>{r.set(e,a)})}});const x=()=>{s.keyword="",s.brandName="",s.brandWebsite="",d.value=null,u.value=""},m=()=>{w("close"),x()},V=async()=>{if(i.value||!k.value)return;i.value=!0,u.value="",d.value=null;const o=p.addExecution({workflowName:"SEO 關鍵字分析器",category:"seo",status:"running",startTime:new Date,inputData:{...s}});try{const e=new FormData;e.append("field-0",s.keyword.trim()),e.append("field-1",s.brandName.trim()),e.append("field-2",s.brandWebsite.trim()),console.log("發送的資料:",{主關鍵詞:s.keyword,品牌名稱:s.brandName,品牌官網:s.brandWebsite});const a=await fetch("https://awesomeseo.zeabur.app/form-test/3ed00c5a-c772-46e1-a44c-13a42ce56cc3",{method:"POST",body:e});if(!a.ok)throw new Error(`HTTP 錯誤！狀態碼: ${a.status}`);const h=await a.json();p.updateExecution(o,{status:"completed",endTime:new Date,outputData:h}),d.value={success:!0,message:"✅ SEO 分析已成功啟動！分析結果將在完成後通知您。",data:h},w("analysis-complete",d.value),setTimeout(()=>{m()},2e3)}catch(e){console.error("分析請求失敗:",e);const a=e instanceof Error?e.message:"未知錯誤";u.value=`分析請求失敗: ${a}`,p.updateExecution(o,{status:"failed",endTime:new Date,errorMessage:u.value})}finally{i.value=!1}};return(o,e)=>o.isVisible?(l(),n("div",{key:0,class:"seo-analyzer-modal",onClick:g(m,["self"])},[t("div",U,[t("div",{class:"modal-header"},[e[4]||(e[4]=t("h2",{class:"modal-title"},"SEO 關鍵字分析器",-1)),t("button",{class:"close-btn",onClick:m},e[3]||(e[3]=[t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2"})],-1)]))]),t("form",{onSubmit:g(V,["prevent"]),class:"analyzer-form"},[t("div",B,[e[5]||(e[5]=t("label",{for:"keyword",class:"form-label"},"目標關鍵字",-1)),v(t("input",{id:"keyword","onUpdate:modelValue":e[0]||(e[0]=a=>s.keyword=a),type:"text",class:"form-input",placeholder:"輸入要分析的關鍵字",required:""},null,512),[[y,s.keyword]])]),t("div",F,[e[6]||(e[6]=t("label",{for:"brandName",class:"form-label"},"品牌名稱",-1)),v(t("input",{id:"brandName","onUpdate:modelValue":e[1]||(e[1]=a=>s.brandName=a),type:"text",class:"form-input",placeholder:"輸入您的品牌名稱",required:""},null,512),[[y,s.brandName]])]),t("div",O,[e[7]||(e[7]=t("label",{for:"brandWebsite",class:"form-label"},"品牌網址",-1)),v(t("input",{id:"brandWebsite","onUpdate:modelValue":e[2]||(e[2]=a=>s.brandWebsite=a),type:"url",class:T(["form-input",{"form-input-error":s.brandWebsite&&!b(s.brandWebsite)}]),placeholder:"https://example.com",required:""},null,2),[[y,s.brandWebsite]]),s.brandWebsite&&!b(s.brandWebsite)?(l(),n("span",A," 請輸入有效的網址格式 ")):c("",!0)]),t("div",q,[t("button",{type:"button",class:"btn-secondary",onClick:m}," 取消 "),t("button",{type:"submit",class:"btn-primary",disabled:i.value||!k.value},[t("div",H,[i.value?(l(),n("div",L)):c("",!0),i.value?(l(),n("span",P,"分析中...")):(l(),n("span",R,"開始分析"))])],8,I)])],32),d.value?(l(),n("div",$,[e[8]||(e[8]=t("h3",{class:"result-title"},"分析結果",-1)),t("div",j,[t("pre",null,W(JSON.stringify(d.value,null,2)),1)])])):c("",!0),u.value?(l(),n("div",G,[t("p",J,W(u.value),1)])):c("",!0)])])):c("",!0)}}),Z=z(Q,[["__scopeId","data-v-dd8696dc"]]);export{Z as default};
